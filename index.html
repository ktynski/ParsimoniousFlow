<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Clifford Torus Flow</title>
    <style>
      :root {
        color-scheme: dark;
        --bg: #070816;
        --panel: rgba(12, 14, 35, 0.72);
        --panel-border: rgba(255, 255, 255, 0.10);
        --text: rgba(255, 255, 255, 0.92);
        --muted: rgba(255, 255, 255, 0.65);
        --accent: #ffd86a;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        background: var(--bg);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--text);
      }

      #app {
        position: fixed;
        inset: 0;
        overflow: hidden;
      }

      #canvas {
        width: 100%;
        height: 100%;
        display: block;
        background: radial-gradient(
          1200px 700px at 60% 40%,
          rgba(36, 42, 120, 0.35),
          rgba(7, 8, 22, 1)
        );
      }

      .hud {
        position: fixed;
        top: 12px;
        left: 12px;
        right: 12px;
        display: grid;
        grid-template-columns: 360px 1fr;
        gap: 12px;
        pointer-events: none; /* canvas interactions still work */
      }

      .panel {
        pointer-events: auto;
        background: var(--panel);
        border: 1px solid var(--panel-border);
        border-radius: 12px;
        backdrop-filter: blur(10px);
        box-shadow: 0 12px 48px rgba(0, 0, 0, 0.35);
      }

      .panel-header {
        padding: 10px 12px;
        border-bottom: 1px solid var(--panel-border);
        display: flex;
        align-items: baseline;
        justify-content: space-between;
        gap: 12px;
      }

      .panel-header .title {
        font-weight: 700;
        letter-spacing: 0.02em;
      }

      .panel-header .hint {
        font-size: 12px;
        color: var(--muted);
        white-space: nowrap;
      }

      .panel-body {
        padding: 10px 12px 12px 12px;
      }

      /* Info panel expects innerHTML with .info-row etc. from src/main.js */
      #info {
        font-size: 12px;
        line-height: 1.3;
      }
      #info .info-row {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        align-items: center;
        margin: 6px 0;
      }
      #info .separator {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid var(--panel-border);
      }
      #info .label {
        color: var(--muted);
      }
      #info .value {
        font-variant-numeric: tabular-nums;
      }
      #info .bar {
        grid-column: 1 / -1;
        height: 6px;
        border-radius: 999px;
        background: linear-gradient(90deg, rgba(255, 216, 106, 0.9), rgba(120, 214, 255, 0.9));
        opacity: 0.75;
      }

      .controls {
        display: grid;
        gap: 10px;
      }

      .control {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        align-items: center;
      }

      .control label {
        color: var(--muted);
        font-size: 12px;
      }

      .control .readout {
        font-size: 12px;
        color: var(--text);
        font-variant-numeric: tabular-nums;
      }

      .control input[type="range"] {
        grid-column: 1 / -1;
        width: 100%;
      }

      .row {
        display: flex;
        align-items: center;
        gap: 10px;
        justify-content: space-between;
      }

      .row label {
        color: var(--muted);
        font-size: 12px;
      }

      .row input[type="checkbox"] {
        transform: translateY(0.5px);
      }

      button {
        width: 100%;
        border: 1px solid var(--panel-border);
        background: rgba(255, 255, 255, 0.06);
        color: var(--text);
        border-radius: 10px;
        padding: 10px 12px;
        cursor: pointer;
        font-weight: 600;
      }
      button:hover {
        background: rgba(255, 255, 255, 0.10);
      }

      .footer-notes {
        margin-top: 10px;
        font-size: 12px;
        color: var(--muted);
      }
      .footer-notes kbd {
        display: inline-block;
        padding: 1px 6px;
        border: 1px solid var(--panel-border);
        border-bottom-color: rgba(255, 255, 255, 0.18);
        border-radius: 6px;
        background: rgba(0, 0, 0, 0.25);
        color: var(--text);
        font-variant-numeric: tabular-nums;
      }

      .error {
        position: fixed;
        inset: 0;
        display: grid;
        place-items: center;
        background: rgba(0, 0, 0, 0.75);
        padding: 24px;
      }
      .error > div {
        max-width: 640px;
        width: 100%;
        background: rgba(18, 20, 40, 0.92);
        border: 1px solid var(--panel-border);
        border-radius: 14px;
        padding: 18px 16px;
      }
      .error h2 {
        margin: 0 0 8px 0;
      }
      .error p {
        margin: 6px 0;
        color: var(--muted);
      }

      @media (max-width: 900px) {
        .hud {
          grid-template-columns: 1fr;
        }
      }

      .mode-indicator {
        margin-left: auto;
        font-size: 12px;
        color: var(--muted);
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .pill {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid var(--panel-border);
        background: rgba(0, 0, 0, 0.25);
        color: var(--text);
        font-weight: 700;
        letter-spacing: 0.02em;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <canvas id="canvas" aria-label="Clifford Torus Flow canvas"></canvas>
    </div>

    <div class="hud" role="presentation">
      <section class="panel" aria-label="Field readout">
        <div class="panel-header">
          <div class="title">Field</div>
          <div class="hint">Drag: orbit • Wheel: zoom</div>
        </div>
        <div class="panel-body">
          <div id="info"></div>
        </div>
      </section>

      <section class="panel" aria-label="Controls">
        <div class="panel-header">
          <div class="title">Controls</div>
          <div class="hint"><kbd>M</kbd> mode • <kbd>Space</kbd> pause</div>
        </div>
        <div class="panel-body">
          <div class="controls">
            <div class="row" style="gap: 12px;">
              <button id="btn-toggle-mode" type="button" style="width: auto;">Toggle Mode</button>
              <div class="mode-indicator" aria-label="Current render mode">
                <span>Mode:</span>
                <span id="mode-indicator" class="pill">EMERGENT</span>
              </div>
            </div>

            <div class="control">
              <label for="param-beta">β (temperature)</label>
              <div class="readout"><span id="val-beta">0.00</span></div>
              <input id="param-beta" type="range" min="0" max="1" step="0.01" />
            </div>

            <div class="control">
              <label for="param-nu">ν (diffusion)</label>
              <div class="readout"><span id="val-nu">0.00</span></div>
              <input id="param-nu" type="range" min="0" max="1" step="0.01" />
            </div>

            <div class="control">
              <label for="param-gamma">γ (spectral gap)</label>
              <div class="readout"><span id="val-gamma">0.00</span></div>
              <input id="param-gamma" type="range" min="0" max="1" step="0.000001" />
            </div>

            <div class="control">
              <label for="param-lambda">λ<sub>max</sub></label>
              <div class="readout"><span id="val-lambda">0.00</span></div>
              <input id="param-lambda" type="range" min="0" max="3" step="0.000001" />
            </div>

            <div class="control">
              <label for="param-grace">Grace scale</label>
              <div class="readout"><span id="val-grace">0.00</span></div>
              <input id="param-grace" type="range" min="0" max="3" step="0.000001" />
            </div>

            <div class="row">
              <label for="param-caustics">Highlight caustics</label>
              <input id="param-caustics" type="checkbox" />
            </div>

            <button id="btn-inject-defect" type="button">Inject Off-Line Zero</button>

            <div class="footer-notes">
              Camera: <kbd>R</kbd> reset • <kbd>T</kbd> throat
            </div>
          </div>
        </div>
      </section>
    </div>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>

